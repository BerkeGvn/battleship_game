(()=>{"use strict";const e=function(e,t,i="horizontal"){const s={name:t,direction:i,isSunk:!1},a=new Array(e).fill(1);function n(){return!!a.every((e=>"X"===e))&&(s.isSunk=!0,!0)}return{details:s,hit:function(e){return!!n()||(a[e]="X",a)},isSink:n,shipSize:a}},t=function(){const t=[];for(let e=0;e<10;e+=1){const e=new Array(10).fill(0);t.push(e)}const i=[e(5,"carrier"),e(4,"battleship"),e(3,"cruiser"),e(2,"destroyer1"),e(2,"destroyer2")];function s(e,t){const i=t;if(i.details.position=[],"vertical"===t.details.direction){i.details.column=e[1];let t=e[0];for(;i.details.position.length<i.shipSize.length;)i.details.position.push(t),t+=1}else{i.details.row=e[0];let t=e[1];for(;i.details.position.length<i.shipSize.length;)i.details.position.push(t),t+=1}}return{board:t,gameover:function(){return!!i.every((e=>!0===e.details.isSunk))},fleet:i,placeShip:function(e,i){if(function(e,t){return"vertical"===t.details.direction&&e[0]+t.shipSize.length>10||"horizontal"===t.details.direction&&e[1]+t.shipSize.length>10}(e,i))return!1;if(function(e,i){let s;if("vertical"===i.details.direction){s=e[0];for(let a=0;a<i.shipSize.length;a+=1)if(1===t[s+a][e[1]])return!0}else for(let a=0;a<i.shipSize.length;a+=1)if(s=e[1],1===t[e[0]][s+a])return!0;return!1}(e,i))return!1;if("vertical"===i.details.direction){for(let s=0;s<i.shipSize.length;s+=1)t[e[0]+s].splice(e[1],1,1);return s(e,i),!0}return t[e[0]].splice(e[1],i.shipSize.length,...i.shipSize),s(e,i),!0},receiveAttack:function(e){return"#"!==t[e[0]][e[1]]&&(1===t[e[0]][e[1]]?(t[e[0]][e[1]]="#",function(e){const t=i.filter((t=>t.details.row===e[0]&&t.details.position.includes(e[1])||t.details.column===e[1]&&t.details.position.includes(e[0])));let s,a;"vertical"===t[0].details.direction?(s=t.filter((t=>t.details.position.includes(e[0]))),a=s[0].details.position.indexOf(e[0])):(s=t.filter((t=>t.details.position.includes(e[1]))),a=s[0].details.position.indexOf(e[1]));const{name:n}=s[0].details;return function(e,t){const s=i.findIndex((t=>t.details.name===e));i[s].hit(t),i[s].isSink()&&(i[s].details.isSunk=!0)}(n,a)}(e)):t[e[0]][e[1]]="#")}}},i=function(){return{gameboard:t(),attack:function(e,t){return e.gameboard.receiveAttack(t)}}},s=(e,t)=>Math.floor(Math.random()*(t-e))+e;let a=i(),n=i();function r(e,t,i){const a=s(0,9),n=s(0,9),o=e.gameboard.placeShip([a,n],t);return!i.includes(`${a}${n}`)&&o?[a,n]:r(e,t,i)}function o(e){const t=[];!function(e){e.gameboard.fleet.forEach((e=>{1===s(0,2)&&(e.details.direction="vertical")}))}(e),e.gameboard.fleet.forEach((i=>{const s=r(e,i,t);t.push(`${s[0]}${s[1]}`),console.log(i),e.gameboard.placeShip(s,i)}))}o(n);const d=document.querySelector(".grid-main-container"),c=document.querySelector(".fleet-container"),l=document.querySelector(".start"),u=document.querySelector(".render"),f=(document.querySelectorAll(".box"),document.querySelectorAll(".ships")),m=document.querySelector(".result"),h=document.querySelector(".winner"),p=document.querySelector(".random"),L=function(){const e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("h1");i.textContent="Your Board",i.classList.add("grid-name");const s=document.createElement("h1");s.textContent="Enemey Board",s.classList.add("grid-name"),e.appendChild(i),t.appendChild(s),e.classList.add("player-grid-container"),e.classList.add("grid-container"),t.classList.add("ai-grid-container"),t.classList.add("grid-container"),t.classList.add("none"),t.classList.add("invisible");for(let i=0;i<10;i+=1){const s=document.createElement("div");s.setAttribute("id",i),s.classList.add(`row-${i}`),s.classList.add("row");const a=document.createElement("div");a.setAttribute("id",i),a.classList.add(`row-2-${i}`),a.classList.add("row");for(let e=0;e<10;e+=1){const t=document.createElement("div");t.classList.add("box"),t.classList.add(`box-${e}`),t.setAttribute("data-y",i),t.setAttribute("data-x",e),s.appendChild(t);const n=document.createElement("div");n.classList.add("box"),n.classList.add(`box-2-${e}`),a.appendChild(n)}e.appendChild(s),t.appendChild(a)}d.appendChild(e),d.appendChild(t)},v=[];let g,b,S=1,x=!0,y=!1,$=!1,E=!1,k=!1;function w(e,t){return!(e>9||e<0||t>9||t<0||"#"===a.gameboard.board[e][t]||v.includes(`${e}${t}`))}function q(e){"axisXLeft"===e&&(y=!1,$=!0),"axisXRight"===e&&($=!1,E=!0),"axisYUpper"===e&&(E=!1,k=!0),"axisYBelow"===e&&(k=!1,x=!0)}function z(e,t,i){let s;!function(e,t){return 1===a.gameboard.board[e][t]}(e,t)?(s=document.querySelector(`.row-${e} .box-${t}`),v.push(`${e}${t}`),S=1,s.classList.add("o"),q(i)):(n.attack(a,[e,t]),v.push(`${e}${t}`),s=document.querySelector(`.row-${e} .box-${t}`),s.classList.add("x"),S+=1)}async function C(){let e,t;if(y){if(e=g,t=b+S,w(e,t))return z(e,t,"axisXLeft");q("axisXLeft"),S=1}if($){if(e=g,t=b-S,w(e,t))return z(e,t,"axisXRight");q("axisXRight"),S=1}if(E){if(e=g-S,t=b,w(e,t))return z(e,t,"axisYUpper");q("axisYUpper"),S=1}if(k){if(e=g+S,t=b,w(e,t))return z(e,t,"axisYBelow");q("axisYBelow"),S=1}if(x){const e=s(0,10),t=s(0,10);if(v.includes(`${e}${t}`))return C();v.push(`${e}${t}`),await(300,new Promise((e=>setTimeout(e,300))));const i=document.querySelector(`.row-${e} .box-${t}`);1===a.gameboard.board[e][t]?(i.classList.add("x"),g=e,b=t,y=!0,$=!1,E=!1,k=!1,x=!1):i.classList.add("o"),n.attack(a,[e,t])}return!0}function A(){return a.gameboard.gameover()?(h.textContent="You lose!",m.classList.remove("none"),!0):!!n.gameboard.gameover()&&(h.textContent="You win!",m.classList.remove("none"),!0)}L();let Y=!0;async function X(){return C(),A(),Y=!0,Y}function B(){for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)1===a.gameboard.board[e][t]&&document.querySelector(`.row-${e} .box-${t}`).classList.add("mark")}B();let R=0;const U=(()=>{const e=document.querySelectorAll(".ships"),t=document.querySelectorAll(".box");let i,s;return{rotate:function(){e.forEach((e=>{e.addEventListener("dblclick",(()=>{"horizontal"===a.gameboard.fleet[i].details.direction?(a.gameboard.fleet[i].details.direction="vertical",e.classList.remove("horizontal"),e.classList.add("vertical")):(a.gameboard.fleet[i].details.direction="horizontal",e.classList.remove("vertical"),e.classList.add("horizontal"))}))}))},drag:function(n=t){const r=e=>{i=a.gameboard.fleet.findIndex((t=>t.details.name===e.target.dataset.name))},o=e=>{s=e.target},d=e=>e.preventDefault(),u=e=>{e.preventDefault(),e.target.classList.add("hover")},f=e=>{e.target.classList.remove("hover")},m=e=>{const t=e.target,n=Number(t.dataset.y),r=Number(t.dataset.x);a.gameboard.placeShip([n,r],a.gameboard.fleet[i])&&(R+=1,s.classList.add("none")),5===R&&(l.classList.remove("fadeout"),l.classList.remove("invisible"),l.classList.add("fadein"),c.classList.add("shrink"),R=0),B(),e.target.classList.remove("hover")};n.forEach((e=>{e.addEventListener("dragover",d),e.addEventListener("dragenter",u),e.addEventListener("dragleave",f),e.addEventListener("drop",m)})),e.forEach((e=>{e.addEventListener("mousedown",r),e.addEventListener("dragstart",o)}))}}})(),D=function(){!function(){for(;d.firstChild;)d.removeChild(d.firstChild)}(),L();const e=document.querySelectorAll(".box");U.drag(e),f.forEach((e=>e.classList.remove("none"))),a=i(),n=i(),o(n),c.classList.remove("shrink"),m.classList.add("none"),p.classList.add("fadein"),v.splice(0,v.length),S=1,x=!0,y=!1,$=!1,E=!1,k=!1};l.addEventListener("click",(()=>{!function(){if(Y){for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)document.querySelector(`.row-2-${e} .box-2-${t}`).addEventListener("click",(i=>{1===n.gameboard.board[e][t]?i.target.classList.add("x"):i.target.classList.add("o"),a.attack(n,[e,t]),A()||X()}),{once:!0});Y=!1}}(),l.classList.remove("fadein"),l.classList.add("fadeout"),l.classList.add("invisible"),p.classList.remove("fadein"),p.classList.add("fadeout");const e=document.querySelector(".ai-grid-container");e.classList.remove("none"),setTimeout((()=>{e.classList.remove("invisible"),e.classList.add("fadein")}),500)})),p.addEventListener("click",(()=>{D(),o(a),function(){for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)1===a.gameboard.board[e][t]&&document.querySelector(`.row-${e} .box-${t}`).classList.add("mark")}(),l.classList.add("fadein"),l.classList.remove("fadeout"),l.classList.remove("invisible"),c.classList.add("shrink")})),u.addEventListener("click",D),U.drag(),U.rotate()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwX2dhbWUvLi9zcmMvbW9kdWxlcy9GYWN0b3JpZXMvc2hpcEZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcF9nYW1lLy4vc3JjL21vZHVsZXMvRmFjdG9yaWVzL2dhbWVib2FyZEZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcF9nYW1lLy4vc3JjL21vZHVsZXMvRmFjdG9yaWVzL1BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwX2dhbWUvLi9zcmMvbW9kdWxlcy9oZWxwZXJzLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXBfZ2FtZS8uL3NyYy9tb2R1bGVzL3BsYXllcnMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcF9nYW1lLy4vc3JjL21vZHVsZXMvZG9tRWxlbWVudHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcF9nYW1lLy4vc3JjL21vZHVsZXMvZ3JpZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwX2dhbWUvLi9zcmMvbW9kdWxlcy9haS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwX2dhbWUvLi9zcmMvbW9kdWxlcy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXBfZ2FtZS8uL3NyYy9tb2R1bGVzL2RyYWdBbmRSb3RhdGUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcF9nYW1lLy4vc3JjL21vZHVsZXMvcmVuZGVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXBfZ2FtZS8uL3NyYy9tb2R1bGVzL21haW5DbGlja0V2ZW50cy5qcyJdLCJuYW1lcyI6WyJsZW5ndGgiLCJuYW1lIiwiZGlyZWN0aW9uIiwiZGV0YWlscyIsImlzU3VuayIsInNoaXBTaXplIiwiQXJyYXkiLCJmaWxsIiwiaXNTaW5rIiwiZXZlcnkiLCJwYXJ0IiwiaGl0IiwicG9zaXRpb24iLCJib2FyZCIsImkiLCJyb3ciLCJwdXNoIiwiZmxlZXQiLCJyZWNvcmRTaGlwcyIsInNoaXBQb3NpdGlvbiIsInNoaXAiLCJyZWNvcmRUaGVTaGlwIiwiY29sdW1uIiwiZ2FtZW92ZXIiLCJwbGFjZVNoaXAiLCJwcmV2ZW50T3ZlckV4dGVuZCIsImNvb3JkIiwiaiIsImNoZWNrQ29vcmRpbmF0ZXMiLCJzcGxpY2UiLCJyZWNlaXZlQXR0YWNrIiwicmVjZWl2ZWRDb29yZCIsImZpbHRlciIsInZhbCIsImluY2x1ZGVzIiwiZGFtYWdlZFNoaXAiLCJkYW1hZ2VkUG9zaXRpb24iLCJpbmRleE9mIiwic2hpcEluZGV4IiwiZmluZEluZGV4IiwiaGl0VGhlU2hpcCIsImNhbGN1bGF0ZUhpdExvYyIsImdhbWVib2FyZCIsImF0dGFjayIsImVuZW15IiwicmFuZG9tIiwibWluIiwibWF4IiwiTWF0aCIsImZsb29yIiwicGxheWVyMSIsInBsYXllcjIiLCJyYW5kb21OdW1iZXJzIiwicGxheWVyIiwicGxhY2VkQ29vcmQiLCJyYW5kb21Sb3ciLCJyYW5kb21Db2x1bW4iLCJwcm9wZXJQbGFjZWQiLCJyYW5kb21QbGFjZW1lbnQiLCJmb3JFYWNoIiwicmFuZG9tRGlyZWN0aW9uIiwicmFuZG9tQ29vcmQiLCJjb25zb2xlIiwibG9nIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZmxlZXRDb250YWluZXIiLCJzdGFydEJ0biIsInJlbmRlckJ0biIsInNoaXBzIiwicXVlcnlTZWxlY3RvckFsbCIsInJlc3VsdFNjcmVlbiIsIndpbm5lciIsInJhbmRvbUJ0biIsInBsYXllck1haW5EaXYiLCJjcmVhdGVFbGVtZW50IiwiYWlNYWluRGl2IiwicGxheWVyMUJvYXJkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJwbGF5ZXIyQm9hcmQiLCJhcHBlbmRDaGlsZCIsInNldEF0dHJpYnV0ZSIsInJvdzIiLCJjb2wiLCJjb2wyIiwicmFuZG9tSGl0Q29vcmQiLCJjb3JyZWNSb3ciLCJjb3JyZWNDb2x1bW4iLCJyYW5kb21TaG90IiwiYXhpc1hMZWZ0IiwiYXhpc1hSaWdodCIsImF4aXNZVXBwZXIiLCJheGlzWUJlbG93IiwicHJvcGVySGl0IiwiY2hhbmdlQXhpcyIsImF4aXMiLCJtYXJrSGl0TG9jYXRpb24iLCJpbm5lckRpdiIsImNvcnJlY3RIaXQiLCJhc3luYyIsImFpSGl0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiY2hlY2tHYW1lb3ZlciIsInJlbW92ZSIsInBsYXllclR1cm4iLCJyYW5kb21IaXQiLCJtYXJrU2hpcERpdnMiLCJzaGlwT25Cb2FyZCIsImdyaWRDZWxscyIsImRyYWdnZWRTaGlwIiwicm90YXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRyYWciLCJjZWxscyIsImdldERyYWdnZWRTaGlwSW5kZXgiLCJlIiwidGFyZ2V0IiwiZGF0YXNldCIsImRyYWdTdGFydCIsImRyYWdPdmVyIiwicHJldmVudERlZmF1bHQiLCJkcmFnRW50ZXIiLCJkcmFnTGVhdmUiLCJkcmFnRHJvcCIsInkiLCJOdW1iZXIiLCJ4IiwiY2VsbCIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInJlbW92ZUdyaWRzIiwib25jZSIsImhpdEV2ZW50IiwibWFya1JhbmRvbVBsYWNlbWVudCJdLCJtYXBwaW5ncyI6Im1CQWlDQSxRQWpDQSxTQUFxQkEsRUFBUUMsRUFBTUMsRUFBWSxjQUM3QyxNQUFNQyxFQUFVLENBQ2RGLE9BQ0FDLFlBQ0FFLFFBQVEsR0FHSkMsRUFBVyxJQUFJQyxNQUFNTixHQUFRTyxLQUFLLEdBRXhDLFNBQVNDLElBQ1AsUUFBSUgsRUFBU0ksT0FBT0MsR0FBa0IsTUFBVEEsTUFDM0JQLEVBQVFDLFFBQVMsR0FDVixHQWFYLE1BQU8sQ0FDTEQsVUFDQVEsSUFWRixTQUFhQyxHQUNYLFFBQUlKLE1BR0pILEVBQVNPLEdBQVksSUFDZFAsSUFNUEcsU0FDQUgsYUMwSEosRUFySkEsV0FDRSxNQUFNUSxFQUFRLEdBRWQsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsR0FBSyxFQUFHLENBQzlCLE1BQU1DLEVBQU0sSUFBSVQsTUFBTSxJQUFJQyxLQUFLLEdBQy9C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QUlBLEdBQUssRUFDM0IsSUFBSyxJQUFJYSxFQUFJLEVBQUdBLEVBQUksR0FBSUEsR0FBSyxFQUNXLElBQWxDdUIsRUFBUVIsVUFBVTdCLE1BQU1DLEdBQUdhLElBQ1pzQyxTQUFTQyxjQUFjLFFBQVFwRCxVQUFVYSxLQUNqRHFELFVBQVVDLElBQUksUUd4RjNCeUQsR0FDQXRFLEVBQVNZLFVBQVVDLElBQUksVUFDdkJiLEVBQVNZLFVBQVU0QixPQUFPLFdBQzFCeEMsRUFBU1ksVUFBVTRCLE9BQU8sYUFDMUJ6QyxFQUFlYSxVQUFVQyxJQUFJLGFBRy9CWixFQUFVK0MsaUJBQWlCLFFBQVMsR0FFcEMsRUFBQUMsT0FDQSxZIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzaGlwRmFjdG9yeShsZW5ndGgsIG5hbWUsIGRpcmVjdGlvbiA9ICdob3Jpem9udGFsJykge1xuICBjb25zdCBkZXRhaWxzID0ge1xuICAgIG5hbWUsXG4gICAgZGlyZWN0aW9uLFxuICAgIGlzU3VuazogZmFsc2UsXG4gIH07XG5cbiAgY29uc3Qgc2hpcFNpemUgPSBuZXcgQXJyYXkobGVuZ3RoKS5maWxsKDEpO1xuXG4gIGZ1bmN0aW9uIGlzU2luaygpIHtcbiAgICBpZiAoc2hpcFNpemUuZXZlcnkoKHBhcnQpID0+IHBhcnQgPT09ICdYJykpIHtcbiAgICAgIGRldGFpbHMuaXNTdW5rID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBoaXQocG9zaXRpb24pIHtcbiAgICBpZiAoaXNTaW5rKCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBzaGlwU2l6ZVtwb3NpdGlvbl0gPSAnWCc7XG4gICAgcmV0dXJuIHNoaXBTaXplO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBkZXRhaWxzLFxuICAgIGhpdCxcbiAgICBpc1NpbmssXG4gICAgc2hpcFNpemUsXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHNoaXBGYWN0b3J5O1xuIiwiaW1wb3J0IHNoaXBGYWN0b3J5IGZyb20gJy4vc2hpcEZhY3RvcnknO1xuXG5mdW5jdGlvbiBnYW1lYm9hcmRGYWN0b3J5KCkge1xuICBjb25zdCBib2FyZCA9IFtdO1xuICAvLyBUbyBjcmVhdGUgZ2FtZWJvYXJkXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgIGNvbnN0IHJvdyA9IG5ldyBBcnJheSgxMCkuZmlsbCgwKTtcbiAgICBib2FyZC5wdXNoKHJvdyk7XG4gIH1cblxuICAvLyBUZWFtcyBlbnRpcmUgZmxlZXRcbiAgY29uc3QgY2FycmllciA9IHNoaXBGYWN0b3J5KDUsICdjYXJyaWVyJyk7XG4gIGNvbnN0IGJhdHRsZXNoaXAgPSBzaGlwRmFjdG9yeSg0LCAnYmF0dGxlc2hpcCcpO1xuICBjb25zdCBjcnVpc2VyID0gc2hpcEZhY3RvcnkoMywgJ2NydWlzZXInKTtcbiAgY29uc3QgZGVzdHJveWVyMSA9IHNoaXBGYWN0b3J5KDIsICdkZXN0cm95ZXIxJyk7XG4gIGNvbnN0IGRlc3Ryb3llcjIgPSBzaGlwRmFjdG9yeSgyLCAnZGVzdHJveWVyMicpO1xuXG4gIC8vIFNhdmluZyB0aGVtIGluIGFycmF5IGZvciBhY2Nlc3NpbmcgdGhlbSBtb3JlIGVhc2lseSBhbmQgZWRpdCB0aGVtXG4gIGNvbnN0IGZsZWV0ID0gW1xuICAgIGNhcnJpZXIsXG4gICAgYmF0dGxlc2hpcCxcbiAgICBjcnVpc2VyLFxuICAgIGRlc3Ryb3llcjEsXG4gICAgZGVzdHJveWVyMixcbiAgXTtcblxuICBmdW5jdGlvbiBnYW1lb3ZlcigpIHtcbiAgICBpZiAoZmxlZXQuZXZlcnkoKHNoaXApID0+IHNoaXAuZGV0YWlscy5pc1N1bmsgPT09IHRydWUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vIFJlY29yZGluZyBzaGlwJ3MgbG9jYXRpb24gZm9yIHJlY2VpdmUgY29ycmVjdCBoaXQgbG9jYXRpb25cbiAgZnVuY3Rpb24gcmVjb3JkU2hpcHMoc2hpcFBvc2l0aW9uLCBzaGlwKSB7XG4gICAgY29uc3QgcmVjb3JkVGhlU2hpcCA9IHNoaXA7XG5cbiAgICByZWNvcmRUaGVTaGlwLmRldGFpbHMucG9zaXRpb24gPSBbXTtcblxuICAgIGlmIChzaGlwLmRldGFpbHMuZGlyZWN0aW9uID09PSAndmVydGljYWwnKSB7XG4gICAgICByZWNvcmRUaGVTaGlwLmRldGFpbHMuY29sdW1uID0gc2hpcFBvc2l0aW9uWzFdO1xuICAgICAgbGV0IHJvdyA9IHNoaXBQb3NpdGlvblswXTtcbiAgICAgIHdoaWxlIChyZWNvcmRUaGVTaGlwLmRldGFpbHMucG9zaXRpb24ubGVuZ3RoIDwgcmVjb3JkVGhlU2hpcC5zaGlwU2l6ZS5sZW5ndGgpIHtcbiAgICAgICAgcmVjb3JkVGhlU2hpcC5kZXRhaWxzLnBvc2l0aW9uLnB1c2gocm93KTtcbiAgICAgICAgcm93ICs9IDE7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlY29yZFRoZVNoaXAuZGV0YWlscy5yb3cgPSBzaGlwUG9zaXRpb25bMF07XG4gICAgICBsZXQgY29sdW1uID0gc2hpcFBvc2l0aW9uWzFdO1xuICAgICAgd2hpbGUgKHJlY29yZFRoZVNoaXAuZGV0YWlscy5wb3NpdGlvbi5sZW5ndGggPCByZWNvcmRUaGVTaGlwLnNoaXBTaXplLmxlbmd0aCkge1xuICAgICAgICByZWNvcmRUaGVTaGlwLmRldGFpbHMucG9zaXRpb24ucHVzaChjb2x1bW4pO1xuICAgICAgICBjb2x1bW4gKz0gMTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gUHJldmVudGluZyBib2FyZCBlbGVtZW50cyB0byBiZSBtb3JlIHRoYW4gMTBcbiAgZnVuY3Rpb24gcHJldmVudE92ZXJFeHRlbmQocG9zaXRpb24sIHNoaXApIHtcbiAgICBpZiAoc2hpcC5kZXRhaWxzLmRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJyAmJiBwb3NpdGlvblswXSArIHNoaXAuc2hpcFNpemUubGVuZ3RoID4gMTApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gaWYgKHNoaXAuZGV0YWlscy5kaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJyAmJiBwb3NpdGlvblsxXSArIHNoaXAuc2hpcFNpemUubGVuZ3RoID4gMTApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBDaGVja2luZyBjb29yZGluYXRlcyBpZiB0aGVyZSBpcyBhIHNoaXAgYWxyZWFkeVxuICBmdW5jdGlvbiBjaGVja0Nvb3JkaW5hdGVzKGNvb3JkLCBzaGlwKSB7XG4gICAgbGV0IGo7XG4gICAgaWYgKHNoaXAuZGV0YWlscy5kaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgIGogPSBjb29yZFswXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaGlwU2l6ZS5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoYm9hcmRbaiArIGldW2Nvb3JkWzFdXSA9PT0gMSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaGlwU2l6ZS5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBqID0gY29vcmRbMV07XG4gICAgICAgIGlmIChib2FyZFtjb29yZFswXV1baiArIGldID09PSAxKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHBvc2l0aW9uLCBzaGlwKSB7XG4gICAgaWYgKHByZXZlbnRPdmVyRXh0ZW5kKHBvc2l0aW9uLCBzaGlwKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoY2hlY2tDb29yZGluYXRlcyhwb3NpdGlvbiwgc2hpcCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoc2hpcC5kZXRhaWxzLmRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNoaXBTaXplLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGJvYXJkW3Bvc2l0aW9uWzBdICsgaV0uc3BsaWNlKHBvc2l0aW9uWzFdLCAxLCAxKTtcbiAgICAgIH1cbiAgICAgIHJlY29yZFNoaXBzKHBvc2l0aW9uLCBzaGlwLCAndmVydGljYWwnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGJvYXJkW3Bvc2l0aW9uWzBdXS5zcGxpY2UocG9zaXRpb25bMV0sIHNoaXAuc2hpcFNpemUubGVuZ3RoLCAuLi5zaGlwLnNoaXBTaXplKTtcbiAgICByZWNvcmRTaGlwcyhwb3NpdGlvbiwgc2hpcCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBoaXRUaGVTaGlwKG5hbWUsIGRhbWFnZWRQb3NpdGlvbikge1xuICAgIGNvbnN0IHNoaXBJbmRleCA9IGZsZWV0LmZpbmRJbmRleCgoc2hpcCkgPT4gc2hpcC5kZXRhaWxzLm5hbWUgPT09IG5hbWUpO1xuICAgIGZsZWV0W3NoaXBJbmRleF0uaGl0KGRhbWFnZWRQb3NpdGlvbik7XG4gICAgaWYgKGZsZWV0W3NoaXBJbmRleF0uaXNTaW5rKCkpIHtcbiAgICAgIGZsZWV0W3NoaXBJbmRleF0uZGV0YWlscy5pc1N1bmsgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbGN1bGF0ZUhpdExvYyhjb29yZCkge1xuICAgIGNvbnN0IHJlY2VpdmVkQ29vcmQgPSBmbGVldC5maWx0ZXIoKHZhbCkgPT4gKHZhbC5kZXRhaWxzLnJvdyA9PT0gY29vcmRbMF1cbiAgICAgICYmIHZhbC5kZXRhaWxzLnBvc2l0aW9uLmluY2x1ZGVzKGNvb3JkWzFdKSlcbiAgICAgIHx8ICh2YWwuZGV0YWlscy5jb2x1bW4gPT09IGNvb3JkWzFdXG4gICAgICAgICYmIHZhbC5kZXRhaWxzLnBvc2l0aW9uLmluY2x1ZGVzKGNvb3JkWzBdKSkpO1xuXG4gICAgbGV0IGRhbWFnZWRTaGlwO1xuICAgIGxldCBkYW1hZ2VkUG9zaXRpb247XG5cbiAgICBpZiAocmVjZWl2ZWRDb29yZFswXS5kZXRhaWxzLmRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgZGFtYWdlZFNoaXAgPSByZWNlaXZlZENvb3JkLmZpbHRlcigodmFsKSA9PiB2YWwuZGV0YWlscy5wb3NpdGlvbi5pbmNsdWRlcyhjb29yZFswXSkpO1xuICAgICAgZGFtYWdlZFBvc2l0aW9uID0gZGFtYWdlZFNoaXBbMF0uZGV0YWlscy5wb3NpdGlvbi5pbmRleE9mKGNvb3JkWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGFtYWdlZFNoaXAgPSByZWNlaXZlZENvb3JkLmZpbHRlcigodmFsKSA9PiB2YWwuZGV0YWlscy5wb3NpdGlvbi5pbmNsdWRlcyhjb29yZFsxXSkpO1xuICAgICAgZGFtYWdlZFBvc2l0aW9uID0gZGFtYWdlZFNoaXBbMF0uZGV0YWlscy5wb3NpdGlvbi5pbmRleE9mKGNvb3JkWzFdKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IG5hbWUgfSA9IGRhbWFnZWRTaGlwWzBdLmRldGFpbHM7XG4gICAgcmV0dXJuIGhpdFRoZVNoaXAobmFtZSwgZGFtYWdlZFBvc2l0aW9uKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2soY29vcmQpIHtcbiAgICBpZiAoYm9hcmRbY29vcmRbMF1dW2Nvb3JkWzFdXSA9PT0gJyMnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChib2FyZFtjb29yZFswXV1bY29vcmRbMV1dID09PSAxKSB7XG4gICAgICBib2FyZFtjb29yZFswXV1bY29vcmRbMV1dID0gJyMnO1xuICAgICAgcmV0dXJuIGNhbGN1bGF0ZUhpdExvYyhjb29yZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkW2Nvb3JkWzBdXVtjb29yZFsxXV0gPSAnIyc7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBib2FyZCwgZ2FtZW92ZXIsIGZsZWV0LCBwbGFjZVNoaXAsIHJlY2VpdmVBdHRhY2ssXG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWVib2FyZEZhY3Rvcnk7XG4iLCJpbXBvcnQgZ2FtZWJvYXJkRmFjdG9yeSBmcm9tICcuL2dhbWVib2FyZEZhY3RvcnknO1xuXG5mdW5jdGlvbiBQbGF5ZXIoKSB7XG4gIGNvbnN0IGdhbWVib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKTtcblxuICBmdW5jdGlvbiBhdHRhY2soZW5lbXksIGNvb3JkKSB7XG4gICAgcmV0dXJuIGVuZW15LmdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3JkKTtcbiAgfVxuXG4gIHJldHVybiB7IGdhbWVib2FyZCwgYXR0YWNrIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBsYXllcjtcbiIsImNvbnN0IHJhbmRvbSA9IChtaW4sIG1heCkgPT4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikpICsgbWluO1xuY29uc3Qgc2xlZXAgPSAobXMpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG5leHBvcnQgeyByYW5kb20sIHNsZWVwIH07XG4iLCJpbXBvcnQgUGxheWVyIGZyb20gJy4vRmFjdG9yaWVzL1BsYXllcic7XG5pbXBvcnQgeyByYW5kb20gfSBmcm9tICcuL2hlbHBlcnMnO1xuXG5sZXQgcGxheWVyMSA9IFBsYXllcigpO1xubGV0IHBsYXllcjIgPSBQbGF5ZXIoKTtcblxuZnVuY3Rpb24gcmVzZXRQbGF5ZXJzKCkge1xuICBwbGF5ZXIxID0gUGxheWVyKCk7XG4gIHBsYXllcjIgPSBQbGF5ZXIodHJ1ZSk7XG59XG5mdW5jdGlvbiByYW5kb21EaXJlY3Rpb24ocGxheWVyKSB7XG4gIHBsYXllci5nYW1lYm9hcmQuZmxlZXQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IHBvc2l0aW9uID0gcmFuZG9tKDAsIDIpO1xuICAgIGlmIChwb3NpdGlvbiA9PT0gMSkge1xuICAgICAgc2hpcC5kZXRhaWxzLmRpcmVjdGlvbiA9ICd2ZXJ0aWNhbCc7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gcmFuZG9tTnVtYmVycyhwbGF5ZXIsIHNoaXAsIHBsYWNlZENvb3JkKSB7XG4gIGNvbnN0IHJhbmRvbVJvdyA9IHJhbmRvbSgwLCA5KTtcbiAgY29uc3QgcmFuZG9tQ29sdW1uID0gcmFuZG9tKDAsIDkpO1xuICBjb25zdCBwcm9wZXJQbGFjZWQgPSBwbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcChbcmFuZG9tUm93LCByYW5kb21Db2x1bW5dLCBzaGlwKTtcbiAgaWYgKCFwbGFjZWRDb29yZC5pbmNsdWRlcyhgJHtyYW5kb21Sb3d9JHtyYW5kb21Db2x1bW59YCkgJiYgcHJvcGVyUGxhY2VkKSB7XG4gICAgcmV0dXJuIFtyYW5kb21Sb3csIHJhbmRvbUNvbHVtbl07XG4gIH1cbiAgcmV0dXJuIHJhbmRvbU51bWJlcnMocGxheWVyLCBzaGlwLCBwbGFjZWRDb29yZCk7XG59XG5cbmZ1bmN0aW9uIHJhbmRvbVBsYWNlbWVudChwbGF5ZXIpIHtcbiAgY29uc3QgcGxhY2VkQ29vcmQgPSBbXTtcbiAgcmFuZG9tRGlyZWN0aW9uKHBsYXllcik7XG4gIHBsYXllci5nYW1lYm9hcmQuZmxlZXQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IHJhbmRvbUNvb3JkID0gcmFuZG9tTnVtYmVycyhwbGF5ZXIsIHNoaXAsIHBsYWNlZENvb3JkKTtcbiAgICBwbGFjZWRDb29yZC5wdXNoKGAke3JhbmRvbUNvb3JkWzBdfSR7cmFuZG9tQ29vcmRbMV19YCk7XG4gICAgY29uc29sZS5sb2coc2hpcCk7XG4gICAgcGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAocmFuZG9tQ29vcmQsIHNoaXApO1xuICB9KTtcbn1cbnJhbmRvbVBsYWNlbWVudChwbGF5ZXIyKTtcbmV4cG9ydCB7XG4gIHBsYXllcjEsIHBsYXllcjIsIHJlc2V0UGxheWVycywgcmFuZG9tUGxhY2VtZW50LFxufTtcbiIsImNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLW1haW4tY29udGFpbmVyJyk7XG5jb25zdCBmbGVldENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbGVldC1jb250YWluZXInKTtcbmNvbnN0IHN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YXJ0Jyk7XG5jb25zdCByZW5kZXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVuZGVyJyk7XG5jb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ib3gnKTtcbmNvbnN0IHNoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNoaXBzJyk7XG5jb25zdCByZXN1bHRTY3JlZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzdWx0Jyk7XG5jb25zdCB3aW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2lubmVyJyk7XG5jb25zdCByYW5kb21CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmFuZG9tJyk7XG5leHBvcnQge1xuICBjb250YWluZXIsIGZsZWV0Q29udGFpbmVyLCBzdGFydEJ0biwgcmVuZGVyQnRuLCBjZWxscywgc2hpcHMsIHJlc3VsdFNjcmVlbiwgd2lubmVyLCByYW5kb21CdG4sXG59O1xuIiwiaW1wb3J0IHsgY29udGFpbmVyIH0gZnJvbSAnLi9kb21FbGVtZW50cyc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUdyaWQoKSB7XG4gIGNvbnN0IHBsYXllck1haW5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgY29uc3QgYWlNYWluRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgY29uc3QgcGxheWVyMUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDEnKTtcbiAgcGxheWVyMUJvYXJkLnRleHRDb250ZW50ID0gJ1lvdXIgQm9hcmQnO1xuICBwbGF5ZXIxQm9hcmQuY2xhc3NMaXN0LmFkZCgnZ3JpZC1uYW1lJyk7XG4gIGNvbnN0IHBsYXllcjJCb2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XG4gIHBsYXllcjJCb2FyZC50ZXh0Q29udGVudCA9ICdFbmVtZXkgQm9hcmQnO1xuICBwbGF5ZXIyQm9hcmQuY2xhc3NMaXN0LmFkZCgnZ3JpZC1uYW1lJyk7XG5cbiAgcGxheWVyTWFpbkRpdi5hcHBlbmRDaGlsZChwbGF5ZXIxQm9hcmQpO1xuICBhaU1haW5EaXYuYXBwZW5kQ2hpbGQocGxheWVyMkJvYXJkKTtcblxuICBwbGF5ZXJNYWluRGl2LmNsYXNzTGlzdC5hZGQoJ3BsYXllci1ncmlkLWNvbnRhaW5lcicpO1xuICBwbGF5ZXJNYWluRGl2LmNsYXNzTGlzdC5hZGQoJ2dyaWQtY29udGFpbmVyJyk7XG4gIGFpTWFpbkRpdi5jbGFzc0xpc3QuYWRkKCdhaS1ncmlkLWNvbnRhaW5lcicpO1xuICBhaU1haW5EaXYuY2xhc3NMaXN0LmFkZCgnZ3JpZC1jb250YWluZXInKTtcbiAgYWlNYWluRGl2LmNsYXNzTGlzdC5hZGQoJ25vbmUnKTtcbiAgYWlNYWluRGl2LmNsYXNzTGlzdC5hZGQoJ2ludmlzaWJsZScpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpICs9IDEpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3cuc2V0QXR0cmlidXRlKCdpZCcsIGkpO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKGByb3ctJHtpfWApO1xuICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdyb3cnKTtcblxuICAgIGNvbnN0IHJvdzIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3cyLnNldEF0dHJpYnV0ZSgnaWQnLCBpKTtcbiAgICByb3cyLmNsYXNzTGlzdC5hZGQoYHJvdy0yLSR7aX1gKTtcbiAgICByb3cyLmNsYXNzTGlzdC5hZGQoJ3JvdycpO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gICAgICBjb25zdCBjb2wgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNvbC5jbGFzc0xpc3QuYWRkKCdib3gnKTtcbiAgICAgIGNvbC5jbGFzc0xpc3QuYWRkKGBib3gtJHtqfWApO1xuICAgICAgY29sLnNldEF0dHJpYnV0ZSgnZGF0YS15JywgaSk7XG4gICAgICBjb2wuc2V0QXR0cmlidXRlKCdkYXRhLXgnLCBqKTtcbiAgICAgIHJvdy5hcHBlbmRDaGlsZChjb2wpO1xuXG4gICAgICBjb25zdCBjb2wyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjb2wyLmNsYXNzTGlzdC5hZGQoJ2JveCcpO1xuICAgICAgY29sMi5jbGFzc0xpc3QuYWRkKGBib3gtMi0ke2p9YCk7XG4gICAgICByb3cyLmFwcGVuZENoaWxkKGNvbDIpO1xuICAgIH1cbiAgICBwbGF5ZXJNYWluRGl2LmFwcGVuZENoaWxkKHJvdyk7XG4gICAgYWlNYWluRGl2LmFwcGVuZENoaWxkKHJvdzIpO1xuICB9XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwbGF5ZXJNYWluRGl2KTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKGFpTWFpbkRpdik7XG59XG5leHBvcnQgZGVmYXVsdCBjcmVhdGVHcmlkO1xuIiwiaW1wb3J0IHsgcmFuZG9tLCBzbGVlcCB9IGZyb20gJy4vaGVscGVycyc7XG5pbXBvcnQgeyBwbGF5ZXIxLCBwbGF5ZXIyIH0gZnJvbSAnLi9wbGF5ZXJzJztcblxuY29uc3QgcmFuZG9tSGl0Q29vcmQgPSBbXTtcbmxldCBwb3NpdGlvbiA9IDE7XG5sZXQgcmFuZG9tU2hvdCA9IHRydWU7XG5sZXQgYXhpc1hMZWZ0ID0gZmFsc2U7XG5sZXQgYXhpc1hSaWdodCA9IGZhbHNlO1xubGV0IGF4aXNZVXBwZXIgPSBmYWxzZTtcbmxldCBheGlzWUJlbG93ID0gZmFsc2U7XG5sZXQgY29ycmVjUm93O1xubGV0IGNvcnJlY0NvbHVtbjtcblxuZnVuY3Rpb24gcHJvcGVySGl0KHJvdywgY29sdW1uKSB7XG4gIGlmIChyb3cgPiA5IHx8IHJvdyA8IDAgfHwgY29sdW1uID4gOSB8fCBjb2x1bW4gPCAwKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChwbGF5ZXIxLmdhbWVib2FyZC5ib2FyZFtyb3ddW2NvbHVtbl0gPT09ICcjJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAoKHJhbmRvbUhpdENvb3JkLmluY2x1ZGVzKGAke3Jvd30ke2NvbHVtbn1gKSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBjb3JyZWN0SGl0KHJvdywgY29sdW1uKSB7XG4gIGlmIChwbGF5ZXIxLmdhbWVib2FyZC5ib2FyZFtyb3ddW2NvbHVtbl0gPT09IDEpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBjaGFuZ2VBeGlzKGF4aXMpIHtcbiAgaWYgKGF4aXMgPT09ICdheGlzWExlZnQnKSB7XG4gICAgYXhpc1hMZWZ0ID0gZmFsc2U7XG4gICAgYXhpc1hSaWdodCA9IHRydWU7XG4gIH1cbiAgaWYgKGF4aXMgPT09ICdheGlzWFJpZ2h0Jykge1xuICAgIGF4aXNYUmlnaHQgPSBmYWxzZTtcbiAgICBheGlzWVVwcGVyID0gdHJ1ZTtcbiAgfVxuICBpZiAoYXhpcyA9PT0gJ2F4aXNZVXBwZXInKSB7XG4gICAgYXhpc1lVcHBlciA9IGZhbHNlO1xuICAgIGF4aXNZQmVsb3cgPSB0cnVlO1xuICB9XG4gIGlmIChheGlzID09PSAnYXhpc1lCZWxvdycpIHtcbiAgICBheGlzWUJlbG93ID0gZmFsc2U7XG4gICAgcmFuZG9tU2hvdCA9IHRydWU7XG4gIH1cbn1cbmZ1bmN0aW9uIG1hcmtIaXRMb2NhdGlvbihyb3csIGNvbHVtbiwgYXhpcykge1xuICBsZXQgaW5uZXJEaXY7XG4gIGlmIChjb3JyZWN0SGl0KHJvdywgY29sdW1uKSkge1xuICAgIHBsYXllcjIuYXR0YWNrKHBsYXllcjEsIFtyb3csIGNvbHVtbl0pO1xuICAgIHJhbmRvbUhpdENvb3JkLnB1c2goYCR7cm93fSR7Y29sdW1ufWApO1xuICAgIGlubmVyRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnJvdy0ke3Jvd30gLmJveC0ke2NvbHVtbn1gKTtcbiAgICBpbm5lckRpdi5jbGFzc0xpc3QuYWRkKCd4Jyk7XG4gICAgcG9zaXRpb24gKz0gMTtcbiAgfSBlbHNlIHtcbiAgICBpbm5lckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5yb3ctJHtyb3d9IC5ib3gtJHtjb2x1bW59YCk7XG4gICAgcmFuZG9tSGl0Q29vcmQucHVzaChgJHtyb3d9JHtjb2x1bW59YCk7XG4gICAgcG9zaXRpb24gPSAxO1xuICAgIGlubmVyRGl2LmNsYXNzTGlzdC5hZGQoJ28nKTtcbiAgICBjaGFuZ2VBeGlzKGF4aXMpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGFpSGl0KCkge1xuICBsZXQgcm93O1xuICBsZXQgY29sdW1uO1xuXG4gIGlmIChheGlzWExlZnQpIHtcbiAgICByb3cgPSBjb3JyZWNSb3c7XG4gICAgY29sdW1uID0gY29ycmVjQ29sdW1uICsgcG9zaXRpb247XG4gICAgaWYgKHByb3BlckhpdChyb3csIGNvbHVtbikpIHtcbiAgICAgIHJldHVybiBtYXJrSGl0TG9jYXRpb24ocm93LCBjb2x1bW4sICdheGlzWExlZnQnKTtcbiAgICAgIC8vIGhhbmdpIHlvbnVuIGZhbHNlIHRydWUgb2xjYWdpbmkgYXlhcmxhbWFtIGxhemltLlxuICAgIH1cbiAgICBjaGFuZ2VBeGlzKCdheGlzWExlZnQnKTtcbiAgICBwb3NpdGlvbiA9IDE7XG4gIH0gaWYgKGF4aXNYUmlnaHQpIHtcbiAgICByb3cgPSBjb3JyZWNSb3c7XG4gICAgY29sdW1uID0gY29ycmVjQ29sdW1uIC0gcG9zaXRpb247XG4gICAgaWYgKHByb3BlckhpdChyb3csIGNvbHVtbikpIHtcbiAgICAgIHJldHVybiBtYXJrSGl0TG9jYXRpb24ocm93LCBjb2x1bW4sICdheGlzWFJpZ2h0Jyk7XG4gICAgfVxuICAgIGNoYW5nZUF4aXMoJ2F4aXNYUmlnaHQnKTtcbiAgICBwb3NpdGlvbiA9IDE7XG4gIH0gaWYgKGF4aXNZVXBwZXIpIHtcbiAgICByb3cgPSBjb3JyZWNSb3cgLSBwb3NpdGlvbjtcbiAgICBjb2x1bW4gPSBjb3JyZWNDb2x1bW47XG4gICAgaWYgKHByb3BlckhpdChyb3csIGNvbHVtbikpIHtcbiAgICAgIHJldHVybiBtYXJrSGl0TG9jYXRpb24ocm93LCBjb2x1bW4sICdheGlzWVVwcGVyJyk7XG4gICAgfVxuICAgIGNoYW5nZUF4aXMoJ2F4aXNZVXBwZXInKTtcbiAgICBwb3NpdGlvbiA9IDE7XG4gIH0gaWYgKGF4aXNZQmVsb3cpIHtcbiAgICByb3cgPSBjb3JyZWNSb3cgKyBwb3NpdGlvbjtcbiAgICBjb2x1bW4gPSBjb3JyZWNDb2x1bW47XG4gICAgaWYgKHByb3BlckhpdChyb3csIGNvbHVtbikpIHtcbiAgICAgIHJldHVybiBtYXJrSGl0TG9jYXRpb24ocm93LCBjb2x1bW4sICdheGlzWUJlbG93Jyk7XG4gICAgfVxuICAgIGNoYW5nZUF4aXMoJ2F4aXNZQmVsb3cnKTtcbiAgICBwb3NpdGlvbiA9IDE7XG4gIH1cbiAgaWYgKHJhbmRvbVNob3QpIHtcbiAgICBjb25zdCByYW5kb21Sb3cgPSByYW5kb20oMCwgMTApO1xuICAgIGNvbnN0IHJhbmRvbUNvbHVtbiA9IHJhbmRvbSgwLCAxMCk7XG4gICAgaWYgKHJhbmRvbUhpdENvb3JkLmluY2x1ZGVzKGAke3JhbmRvbVJvd30ke3JhbmRvbUNvbHVtbn1gKSkge1xuICAgICAgcmV0dXJuIGFpSGl0KCk7XG4gICAgfVxuXG4gICAgcmFuZG9tSGl0Q29vcmQucHVzaChgJHtyYW5kb21Sb3d9JHtyYW5kb21Db2x1bW59YCk7XG4gICAgYXdhaXQgc2xlZXAoMzAwKTtcblxuICAgIGNvbnN0IGlubmVyRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnJvdy0ke3JhbmRvbVJvd30gLmJveC0ke3JhbmRvbUNvbHVtbn1gKTtcbiAgICBpZiAocGxheWVyMS5nYW1lYm9hcmQuYm9hcmRbcmFuZG9tUm93XVtyYW5kb21Db2x1bW5dID09PSAxKSB7XG4gICAgICBpbm5lckRpdi5jbGFzc0xpc3QuYWRkKCd4Jyk7XG4gICAgICBjb3JyZWNSb3cgPSByYW5kb21Sb3c7XG4gICAgICBjb3JyZWNDb2x1bW4gPSByYW5kb21Db2x1bW47XG4gICAgICBheGlzWExlZnQgPSB0cnVlO1xuICAgICAgYXhpc1hSaWdodCA9IGZhbHNlO1xuICAgICAgYXhpc1lVcHBlciA9IGZhbHNlO1xuICAgICAgYXhpc1lCZWxvdyA9IGZhbHNlO1xuICAgICAgcmFuZG9tU2hvdCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbm5lckRpdi5jbGFzc0xpc3QuYWRkKCdvJyk7XG4gICAgfVxuXG4gICAgcGxheWVyMi5hdHRhY2socGxheWVyMSwgW3JhbmRvbVJvdywgcmFuZG9tQ29sdW1uXSk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGFpUmVzZXQoKSB7XG4gIHJhbmRvbUhpdENvb3JkLnNwbGljZSgwLCByYW5kb21IaXRDb29yZC5sZW5ndGgpO1xuICBwb3NpdGlvbiA9IDE7XG4gIHJhbmRvbVNob3QgPSB0cnVlO1xuICBheGlzWExlZnQgPSBmYWxzZTtcbiAgYXhpc1hSaWdodCA9IGZhbHNlO1xuICBheGlzWVVwcGVyID0gZmFsc2U7XG4gIGF4aXNZQmVsb3cgPSBmYWxzZTtcbn1cbmV4cG9ydCB7IGFpSGl0LCBhaVJlc2V0IH07XG4iLCJpbXBvcnQgeyBwbGF5ZXIxLCBwbGF5ZXIyIH0gZnJvbSAnLi9wbGF5ZXJzJztcbmltcG9ydCBjcmVhdGVHcmlkIGZyb20gJy4vZ3JpZCc7XG5pbXBvcnQgeyByZXN1bHRTY3JlZW4sIHdpbm5lciB9IGZyb20gJy4vZG9tRWxlbWVudHMnO1xuaW1wb3J0IHsgYWlIaXQgfSBmcm9tICcuL2FpJztcblxuY3JlYXRlR3JpZCgpO1xuXG5mdW5jdGlvbiBjaGVja0dhbWVvdmVyKCkge1xuICBpZiAocGxheWVyMS5nYW1lYm9hcmQuZ2FtZW92ZXIoKSkge1xuICAgIHdpbm5lci50ZXh0Q29udGVudCA9ICdZb3UgbG9zZSEnO1xuICAgIHJlc3VsdFNjcmVlbi5jbGFzc0xpc3QucmVtb3ZlKCdub25lJyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHBsYXllcjIuZ2FtZWJvYXJkLmdhbWVvdmVyKCkpIHtcbiAgICB3aW5uZXIudGV4dENvbnRlbnQgPSAnWW91IHdpbiEnO1xuICAgIHJlc3VsdFNjcmVlbi5jbGFzc0xpc3QucmVtb3ZlKCdub25lJyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5sZXQgcGxheWVyVHVybiA9IHRydWU7XG4vKiBjb25zdCByYW5kb21IaXRDb29yZCA9IFtdO1xubGV0IHBvc2l0aW9uID0gMTtcbmxldCByYW5kb21TaG90ID0gdHJ1ZTtcbmxldCBheGlzWExlZnQgPSBmYWxzZTtcbmxldCBheGlzWFJpZ2h0ID0gZmFsc2U7XG5sZXQgYXhpc1lVcHBlciA9IGZhbHNlO1xubGV0IGF4aXNZQmVsb3cgPSBmYWxzZTtcbmxldCBjb3JyZWNSb3c7XG5sZXQgY29ycmVjQ29sdW1uO1xuXG5mdW5jdGlvbiBwcm9wZXJIaXQocm93LCBjb2x1bW4pIHtcbiAgaWYgKHJvdyA+IDkgfHwgcm93IDwgMCB8fCBjb2x1bW4gPiA5IHx8IGNvbHVtbiA8IDApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYgKHBsYXllcjEuZ2FtZWJvYXJkLmJvYXJkW3Jvd11bY29sdW1uXSA9PT0gJyMnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICgocmFuZG9tSGl0Q29vcmQuaW5jbHVkZXMoYCR7cm93fSR7Y29sdW1ufWApKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGNvcnJlY3RIaXQocm93LCBjb2x1bW4pIHtcbiAgaWYgKHBsYXllcjEuZ2FtZWJvYXJkLmJvYXJkW3Jvd11bY29sdW1uXSA9PT0gMSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGNoYW5nZUF4aXMoYXhpcykge1xuICBpZiAoYXhpcyA9PT0gJ2F4aXNYTGVmdCcpIHtcbiAgICBheGlzWExlZnQgPSBmYWxzZTtcbiAgICBheGlzWFJpZ2h0ID0gdHJ1ZTtcbiAgfVxuICBpZiAoYXhpcyA9PT0gJ2F4aXNYUmlnaHQnKSB7XG4gICAgYXhpc1hSaWdodCA9IGZhbHNlO1xuICAgIGF4aXNZVXBwZXIgPSB0cnVlO1xuICB9XG4gIGlmIChheGlzID09PSAnYXhpc1lVcHBlcicpIHtcbiAgICBheGlzWVVwcGVyID0gZmFsc2U7XG4gICAgYXhpc1lCZWxvdyA9IHRydWU7XG4gIH1cbiAgaWYgKGF4aXMgPT09ICdheGlzWUJlbG93Jykge1xuICAgIGF4aXNZQmVsb3cgPSBmYWxzZTtcbiAgICByYW5kb21TaG90ID0gdHJ1ZTtcbiAgfVxufVxuZnVuY3Rpb24gbWFya0hpdExvY2F0aW9uKHJvdywgY29sdW1uLCBheGlzKSB7XG4gIGxldCBpbm5lckRpdjtcbiAgaWYgKGNvcnJlY3RIaXQocm93LCBjb2x1bW4pKSB7XG4gICAgcGxheWVyMi5hdHRhY2socGxheWVyMSwgW3JvdywgY29sdW1uXSk7XG4gICAgcmFuZG9tSGl0Q29vcmQucHVzaChgJHtyb3d9JHtjb2x1bW59YCk7XG4gICAgaW5uZXJEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucm93LSR7cm93fSAuYm94LSR7Y29sdW1ufWApO1xuICAgIGlubmVyRGl2LmNsYXNzTGlzdC5hZGQoJ3gnKTtcbiAgICBwb3NpdGlvbiArPSAxO1xuICB9IGVsc2Uge1xuICAgIGlubmVyRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnJvdy0ke3Jvd30gLmJveC0ke2NvbHVtbn1gKTtcbiAgICByYW5kb21IaXRDb29yZC5wdXNoKGAke3Jvd30ke2NvbHVtbn1gKTtcbiAgICBwb3NpdGlvbiA9IDE7XG4gICAgaW5uZXJEaXYuY2xhc3NMaXN0LmFkZCgnbycpO1xuICAgIGNoYW5nZUF4aXMoYXhpcyk7XG4gIH1cbn0gKi9cblxuYXN5bmMgZnVuY3Rpb24gcmFuZG9tSGl0KCkge1xuICBhaUhpdCgpO1xuICBjaGVja0dhbWVvdmVyKCk7XG4gIHBsYXllclR1cm4gPSB0cnVlO1xuICByZXR1cm4gcGxheWVyVHVybjtcbn1cbi8qIGFzeW5jIGZ1bmN0aW9uIHJhbmRvbUhpdCgpIHtcbiAgY29uc3QgcmFuZG9tUm93ID0gcmFuZG9tKDAsIDEwKTtcbiAgY29uc3QgcmFuZG9tQ29sdW1uID0gcmFuZG9tKDAsIDEwKTtcbiAgaWYgKHJhbmRvbUhpdENvb3JkLmluY2x1ZGVzKGAke3JhbmRvbVJvd30ke3JhbmRvbUNvbHVtbn1gKSkge1xuICAgIHJldHVybiByYW5kb21IaXQoKTtcbiAgfVxuICByYW5kb21IaXRDb29yZC5wdXNoKGAke3JhbmRvbVJvd30ke3JhbmRvbUNvbHVtbn1gKTtcbiAgYXdhaXQgc2xlZXAoMzAwKTtcblxuICBjb25zdCBpbm5lckRpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5yb3ctJHtyYW5kb21Sb3d9IC5ib3gtJHtyYW5kb21Db2x1bW59YCk7XG5cbiAgaWYgKHBsYXllcjEuZ2FtZWJvYXJkLmJvYXJkW3JhbmRvbVJvd11bcmFuZG9tQ29sdW1uXSA9PT0gMSkge1xuICAgIGlubmVyRGl2LmNsYXNzTGlzdC5hZGQoJ3gnKTtcbiAgfSBlbHNlIHtcbiAgICBpbm5lckRpdi5jbGFzc0xpc3QuYWRkKCdvJyk7XG4gIH1cblxuICBwbGF5ZXIyLmF0dGFjayhwbGF5ZXIxLCBbcmFuZG9tUm93LCByYW5kb21Db2x1bW5dKTtcblxuICBjaGVja0dhbWVvdmVyKCk7XG4gIHBsYXllclR1cm4gPSB0cnVlO1xuICByZXR1cm4gcGxheWVyVHVybjtcbn0gKi9cbmZ1bmN0aW9uIG1hcmtSYW5kb21QbGFjZW1lbnQoKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGogKz0gMSkge1xuICAgICAgaWYgKHBsYXllcjEuZ2FtZWJvYXJkLmJvYXJkW2ldW2pdID09PSAxKSB7XG4gICAgICAgIGNvbnN0IGlubmVyRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnJvdy0ke2l9IC5ib3gtJHtqfWApO1xuICAgICAgICBpbm5lckRpdi5jbGFzc0xpc3QuYWRkKCdtYXJrJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIG1hcmtTaGlwRGl2cygpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSArPSAxKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gICAgICBpZiAocGxheWVyMS5nYW1lYm9hcmQuYm9hcmRbaV1bal0gPT09IDEpIHtcbiAgICAgICAgY29uc3QgYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnJvdy0ke2l9IC5ib3gtJHtqfWApO1xuICAgICAgICBib3guY2xhc3NMaXN0LmFkZCgnbWFyaycpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tYXJrU2hpcERpdnMoKTtcblxuZnVuY3Rpb24gaGl0RXZlbnQoKSB7XG4gIGlmIChwbGF5ZXJUdXJuKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSArPSAxKSB7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqICs9IDEpIHtcbiAgICAgICAgY29uc3QgYXEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucm93LTItJHtpfSAuYm94LTItJHtqfWApO1xuXG4gICAgICAgIGFxLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICBpZiAocGxheWVyMi5nYW1lYm9hcmQuYm9hcmRbaV1bal0gPT09IDEpIHtcbiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3gnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnbycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwbGF5ZXIxLmF0dGFjayhwbGF5ZXIyLCBbaSwgal0pO1xuICAgICAgICAgIGlmIChjaGVja0dhbWVvdmVyKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmFuZG9tSGl0KCk7XG4gICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcGxheWVyVHVybiA9IGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCB7XG4gIGhpdEV2ZW50LCBtYXJrU2hpcERpdnMsIG1hcmtSYW5kb21QbGFjZW1lbnQsXG59O1xuIiwiaW1wb3J0IHsgcGxheWVyMSB9IGZyb20gJy4vcGxheWVycyc7XG5pbXBvcnQgeyBtYXJrU2hpcERpdnMgfSBmcm9tICcuL2dhbWUnO1xuaW1wb3J0IHsgc3RhcnRCdG4sIGZsZWV0Q29udGFpbmVyIH0gZnJvbSAnLi9kb21FbGVtZW50cyc7XG5cbmxldCBzaGlwT25Cb2FyZCA9IDA7XG5jb25zdCBkcmFnQW5kUm90YXRlID0gKCgpID0+IHtcbiAgY29uc3Qgc2hpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2hpcHMnKTtcbiAgY29uc3QgZ3JpZENlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJveCcpO1xuXG4gIGxldCBzaGlwSW5kZXg7XG4gIGxldCBkcmFnZ2VkU2hpcDtcblxuICBmdW5jdGlvbiByb3RhdGUoKSB7XG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgc2hpcC5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHBsYXllcjEuZ2FtZWJvYXJkLmZsZWV0W3NoaXBJbmRleF0uZGV0YWlscy5kaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgIHBsYXllcjEuZ2FtZWJvYXJkLmZsZWV0W3NoaXBJbmRleF0uZGV0YWlscy5kaXJlY3Rpb24gPSAndmVydGljYWwnO1xuICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LnJlbW92ZSgnaG9yaXpvbnRhbCcpO1xuICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZCgndmVydGljYWwnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwbGF5ZXIxLmdhbWVib2FyZC5mbGVldFtzaGlwSW5kZXhdLmRldGFpbHMuZGlyZWN0aW9uID0gJ2hvcml6b250YWwnO1xuICAgICAgICAgIHNoaXAuY2xhc3NMaXN0LnJlbW92ZSgndmVydGljYWwnKTtcbiAgICAgICAgICBzaGlwLmNsYXNzTGlzdC5hZGQoJ2hvcml6b250YWwnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBkcmFnKGNlbGxzID0gZ3JpZENlbGxzKSB7XG4gICAgY29uc3QgZ2V0RHJhZ2dlZFNoaXBJbmRleCA9IChlKSA9PiB7XG4gICAgICBzaGlwSW5kZXggPSBwbGF5ZXIxLmdhbWVib2FyZC5mbGVldC5maW5kSW5kZXgoKHNoaXApID0+IHNoaXAuZGV0YWlscy5uYW1lID09PSBlLnRhcmdldC5kYXRhc2V0Lm5hbWUpO1xuICAgIH07XG5cbiAgICBjb25zdCBkcmFnU3RhcnQgPSAoZSkgPT4ge1xuICAgICAgZHJhZ2dlZFNoaXAgPSBlLnRhcmdldDtcbiAgICB9O1xuXG4gICAgY29uc3QgZHJhZ092ZXIgPSAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgZHJhZ0VudGVyID0gKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2hvdmVyJyk7XG4gICAgfTtcblxuICAgIGNvbnN0IGRyYWdMZWF2ZSA9IChlKSA9PiB7XG4gICAgICBlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdob3ZlcicpO1xuICAgIH07XG5cbiAgICBjb25zdCBkcmFnRHJvcCA9IChlKSA9PiB7XG4gICAgICBjb25zdCBjb29yZCA9IGUudGFyZ2V0O1xuICAgICAgY29uc3QgeSA9IE51bWJlcihjb29yZC5kYXRhc2V0LnkpO1xuICAgICAgY29uc3QgeCA9IE51bWJlcihjb29yZC5kYXRhc2V0LngpO1xuXG4gICAgICBjb25zdCBwcm9wZXJQbGFjZWQgPSBwbGF5ZXIxLmdhbWVib2FyZC5wbGFjZVNoaXAoW3ksIHhdLCBwbGF5ZXIxLmdhbWVib2FyZC5mbGVldFtzaGlwSW5kZXhdKTtcbiAgICAgIGlmIChwcm9wZXJQbGFjZWQpIHtcbiAgICAgICAgc2hpcE9uQm9hcmQgKz0gMTtcbiAgICAgICAgZHJhZ2dlZFNoaXAuY2xhc3NMaXN0LmFkZCgnbm9uZScpO1xuICAgICAgfVxuICAgICAgaWYgKHNoaXBPbkJvYXJkID09PSA1KSB7XG4gICAgICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVvdXQnKTtcbiAgICAgICAgc3RhcnRCdG4uY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJyk7XG4gICAgICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5hZGQoJ2ZhZGVpbicpO1xuICAgICAgICBmbGVldENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaHJpbmsnKTtcblxuICAgICAgICBzaGlwT25Cb2FyZCA9IDA7XG4gICAgICB9XG5cbiAgICAgIG1hcmtTaGlwRGl2cygpO1xuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnaG92ZXInKTtcbiAgICB9O1xuXG4gICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGRyYWdPdmVyKTtcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgZHJhZ0VudGVyKTtcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgZHJhZ0xlYXZlKTtcbiAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGRyYWdEcm9wKTtcbiAgICB9KTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIHNoaXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZ2V0RHJhZ2dlZFNoaXBJbmRleCk7XG4gICAgICBzaGlwLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGRyYWdTdGFydCk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHsgcm90YXRlLCBkcmFnIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBkcmFnQW5kUm90YXRlO1xuIiwiaW1wb3J0IHtcbiAgY29udGFpbmVyLCBzaGlwcywgZmxlZXRDb250YWluZXIsIHJlc3VsdFNjcmVlbiwgcmFuZG9tQnRuLFxufSBmcm9tICcuL2RvbUVsZW1lbnRzJztcbmltcG9ydCBjcmVhdGVHcmlkIGZyb20gJy4vZ3JpZCc7XG5pbXBvcnQgeyBwbGF5ZXIyLCByZXNldFBsYXllcnMsIHJhbmRvbVBsYWNlbWVudCB9IGZyb20gJy4vcGxheWVycyc7XG5pbXBvcnQgZHJhZ0FuZFJvdGF0ZSBmcm9tICcuL2RyYWdBbmRSb3RhdGUnO1xuaW1wb3J0IHsgYWlSZXNldCB9IGZyb20gJy4vYWknO1xuXG5mdW5jdGlvbiByZXNldERvbUVsZW1lbnRzKCkge1xuICBmbGVldENvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdzaHJpbmsnKTtcbiAgcmVzdWx0U2NyZWVuLmNsYXNzTGlzdC5hZGQoJ25vbmUnKTtcbiAgcmFuZG9tQnRuLmNsYXNzTGlzdC5hZGQoJ2ZhZGVpbicpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVHcmlkcygpIHtcbiAgd2hpbGUgKGNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKGNvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkaXNwbGF5U2hpcENvbnRhaW5lcigpIHtcbiAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4gc2hpcC5jbGFzc0xpc3QucmVtb3ZlKCdub25lJykpO1xufVxuXG5mdW5jdGlvbiByZW5kZXIoKSB7XG4gIHJlbW92ZUdyaWRzKCk7XG5cbiAgY3JlYXRlR3JpZCgpO1xuXG4gIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJveCcpO1xuXG4gIGRyYWdBbmRSb3RhdGUuZHJhZyhjZWxscyk7XG4gIGRpc3BsYXlTaGlwQ29udGFpbmVyKCk7XG4gIHJlc2V0UGxheWVycygpO1xuICByYW5kb21QbGFjZW1lbnQocGxheWVyMik7XG4gIHJlc2V0RG9tRWxlbWVudHMoKTtcbiAgYWlSZXNldCgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCByZW5kZXI7XG4iLCJpbXBvcnQgeyBoaXRFdmVudCwgbWFya1JhbmRvbVBsYWNlbWVudCB9IGZyb20gJy4vZ2FtZSc7XG5pbXBvcnQgZHJhZ0FuZFJvdGF0ZSBmcm9tICcuL2RyYWdBbmRSb3RhdGUnO1xuaW1wb3J0IHsgcmFuZG9tUGxhY2VtZW50LCBwbGF5ZXIxIH0gZnJvbSAnLi9wbGF5ZXJzJztcbmltcG9ydCB7XG4gIHN0YXJ0QnRuLCByZW5kZXJCdG4sIHJhbmRvbUJ0biwgZmxlZXRDb250YWluZXIsXG59IGZyb20gJy4vZG9tRWxlbWVudHMnO1xuaW1wb3J0IHJlbmRlciBmcm9tICcuL3JlbmRlcic7XG5cbmZ1bmN0aW9uIEV2ZW50cygpIHtcbiAgc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaGl0RXZlbnQoKTtcblxuICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVpbicpO1xuICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5hZGQoJ2ZhZGVvdXQnKTtcbiAgICBzdGFydEJ0bi5jbGFzc0xpc3QuYWRkKCdpbnZpc2libGUnKTtcblxuICAgIHJhbmRvbUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdmYWRlaW4nKTtcbiAgICByYW5kb21CdG4uY2xhc3NMaXN0LmFkZCgnZmFkZW91dCcpO1xuXG4gICAgY29uc3QgYWlNYWluRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFpLWdyaWQtY29udGFpbmVyJyk7XG4gICAgYWlNYWluRGl2LmNsYXNzTGlzdC5yZW1vdmUoJ25vbmUnKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYWlNYWluRGl2LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmlzaWJsZScpO1xuICAgICAgYWlNYWluRGl2LmNsYXNzTGlzdC5hZGQoJ2ZhZGVpbicpO1xuICAgIH0sIDUwMCk7XG4gIH0pO1xuXG4gIHJhbmRvbUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICByZW5kZXIoKTtcbiAgICByYW5kb21QbGFjZW1lbnQocGxheWVyMSk7XG4gICAgbWFya1JhbmRvbVBsYWNlbWVudCgpO1xuICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5hZGQoJ2ZhZGVpbicpO1xuICAgIHN0YXJ0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVvdXQnKTtcbiAgICBzdGFydEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKTtcbiAgICBmbGVldENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzaHJpbmsnKTtcbiAgfSk7XG5cbiAgcmVuZGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVuZGVyKTtcblxuICBkcmFnQW5kUm90YXRlLmRyYWcoKTtcbiAgZHJhZ0FuZFJvdGF0ZS5yb3RhdGUoKTtcbn1cbmV4cG9ydCBkZWZhdWx0IEV2ZW50cztcbiJdLCJzb3VyY2VSb290IjoiIn0=